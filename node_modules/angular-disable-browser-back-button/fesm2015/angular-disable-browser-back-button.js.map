{"version":3,"file":"angular-disable-browser-back-button.js","sources":["ng://angular-disable-browser-back-button/public_api.ts","ng://angular-disable-browser-back-button/angular-disable-browser-back-button.ts"],"sourcesContent":["import { NgModule, Injectable, ModuleWithProviders, Inject } from '@angular/core';\nimport { Router, NavigationEnd } from '@angular/router';\n\nfunction _window(): any {\n  return window;\n}\n\n@Injectable()\nexport class WindowRef {\n  get nativeWindow(): any {\n    return _window();\n  }\n}\n\n@NgModule({\n  providers: [WindowRef]\n})\nexport class BackButtonDisableModule {\n\n  private window: Window;\n  private scrollX = 0;\n  private scrollY = 0;\n\n  constructor(\n    private router: Router,\n    private windowRef: WindowRef,\n    @Inject('preserveScrollPosition') private preserveScrollPosition: boolean\n  ) {\n    this.window = this.windowRef.nativeWindow\n    this.disableBackButton();\n    this.addPopStateEventListener();\n  }\n\n  static forRoot(config?: { preserveScrollPosition: boolean }): ModuleWithProviders {\n    return {\n      ngModule: BackButtonDisableModule,\n      providers: [\n        {\n          provide: 'preserveScrollPosition',\n          useValue: config && 'preserveScrollPosition' in config ? config.preserveScrollPosition : false\n        }\n      ]\n    }\n  }\n\n  private addPopStateEventListener(): void {\n    this.window.addEventListener('popstate', () => {\n      if (this.preserveScrollPosition) this.getScrollCoordinates();\n      this.window.history.pushState(null, null, null);\n      if (this.preserveScrollPosition) setTimeout(this.scrollToThePreviousPosition.bind(this));\n    });\n  }\n\n  private scrollToThePreviousPosition(): void {\n    this.window.scrollTo(this.scrollX, this.scrollY);\n  }\n\n  private getScrollCoordinates(): void {\n    this.scrollX = this.window.scrollX;\n    this.scrollY = this.window.scrollY;\n  }\n\n  private disableBackButton(): void {\n    this.window.history.pushState(null, null, null);\n    this.router.events.subscribe(event => {\n      if (event instanceof NavigationEnd) {\n        this.window.history.pushState(null, null, null);\n      };\n    });\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["tslib_1.__param"],"mappings":";;;;;AAAA,AAGA,SAAS,OAAO;IACd,OAAO,MAAM,CAAC;CACf;AAGD,IAAa,SAAS,GAAtB,MAAa,SAAS;IACpB,IAAI,YAAY;QACd,OAAO,OAAO,EAAE,CAAC;KAClB;CACF,CAAA;AAJY,SAAS;IADrB,UAAU,EAAE;GACA,SAAS,CAIrB;IAKY,uBAAuB,+BAApC,MAAa,uBAAuB;IAMlC,YACU,MAAc,EACd,SAAoB,EACc,sBAA+B;QAFjE,WAAM,GAAN,MAAM,CAAQ;QACd,cAAS,GAAT,SAAS,CAAW;QACc,2BAAsB,GAAtB,sBAAsB,CAAS;QANnE,YAAO,GAAG,CAAC,CAAC;QACZ,YAAO,GAAG,CAAC,CAAC;QAOlB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAA;QACzC,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,wBAAwB,EAAE,CAAC;KACjC;IAED,OAAO,OAAO,CAAC,MAA4C;QACzD,OAAO;YACL,QAAQ,EAAE,yBAAuB;YACjC,SAAS,EAAE;gBACT;oBACE,OAAO,EAAE,wBAAwB;oBACjC,QAAQ,EAAE,MAAM,IAAI,wBAAwB,IAAI,MAAM,GAAG,MAAM,CAAC,sBAAsB,GAAG,KAAK;iBAC/F;aACF;SACF,CAAA;KACF;IAEO,wBAAwB;QAC9B,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE;YACvC,IAAI,IAAI,CAAC,sBAAsB;gBAAE,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC7D,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;YAChD,IAAI,IAAI,CAAC,sBAAsB;gBAAE,UAAU,CAAC,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SAC1F,CAAC,CAAC;KACJ;IAEO,2BAA2B;QACjC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;KAClD;IAEO,oBAAoB;QAC1B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;QACnC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;KACpC;IAEO,iBAAiB;QACvB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAChD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK;YAChC,IAAI,KAAK,YAAY,aAAa,EAAE;gBAClC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;aACjD;YAAA,CAAC;SACH,CAAC,CAAC;KACJ;CACF,CAAA;;YA9CmB,MAAM;YACH,SAAS;0CAC3B,MAAM,SAAC,wBAAwB;;AATvB,uBAAuB;IAHnC,QAAQ,CAAC;QACR,SAAS,EAAE,CAAC,SAAS,CAAC;KACvB,CAAC;IAUGA,WAAA,MAAM,CAAC,wBAAwB,CAAC,CAAA;GATxB,uBAAuB,CAqDnC;;ACtED;;GAEG;;;;"}